#include <ESP32Servo.h> 

int sensorSuperiorDireito = 32;
int sensorSuperiorEsquerdo = 33;
int sensorInferiorDireito = 26;
int sensorInferiorEsquerdo= 25;

Servo servox;  
int posicaoX = 180;
int limitiMaximoX = 175;
int limitiMinimoX = 5;

Servo servoy;
int posicaoY = 45;
int limitiMaximoY = 175;
int limitiMinimoY = 30;



void setup() {
  //Serial.begin(9600);
  servox.attach(27);
  servoy.attach(14);
  
  servox.write(180);
  servoy.write(45);
  delay(2500);

}

void loop() {
  int leituraSuperiorDireito = analogRead(sensorSuperiorDireito); 
  int leituraSuperiorEsquerdo = analogRead(sensorSuperiorEsquerdo);
  int leituraInferiorDireito = analogRead(sensorInferiorDireito);
  int leituraInferiorEsquerdo = analogRead(sensorInferiorEsquerdo);

  int tolerancia = 90;

  int mediaSuperior = (leituraSuperiorDireito + leituraSuperiorEsquerdo) / 2;
  int mediaInferior = (leituraInferiorDireito + leituraInferiorEsquerdo) / 2;

  int mediaDireita = (leituraSuperiorDireito + leituraInferiorDireito) / 2;
  int mediaEsquerda = (leituraSuperiorEsquerdo + leituraInferiorEsquerdo) / 2;

  int diferencaSupInf = mediaSuperior - mediaInferior;
  int diferencaDirEsq = mediaDireita - mediaEsquerda;

  if(abs(diferencaSupInf) > tolerancia){
    if(mediaSuperior > mediaInferior){
      posicaoY = --posicaoY;
      if(posicaoY < limitiMinimoY){
        posicaoY = limitiMinimoY;
      }
    }
    else /*if(mediaInferior > mediaSuperior)*/{
      posicaoY = ++posicaoY;
      if(posicaoY > limitiMaximoY){
        posicaoY = limitiMaximoY;
      }
    }
    servoy.write(posicaoY);
  }

  if(abs(diferencaDirEsq) > tolerancia){
    if(mediaDireita > mediaEsquerda){
      posicaoX = ++posicaoX;
      if(posicaoX > limitiMaximoX){
        posicaoX = posicaoX = limitiMaximoX;
      }
    }
    else /*if(mediaEsquerda > mediaDireita)*/{
      posicaoX = --posicaoX;
      if(posicaoX <  limitiMinimoX){
        posicaoX = posicaoX = limitiMinimoX;
      }
    }
    servox.write(posicaoX);
  }
  delay(10);
}
